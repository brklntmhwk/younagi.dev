---
import { getEntry } from 'astro:content'
import type { UnsplashPhotoData } from '@/lib/unsplash/getContent'
import { getPhotographer } from '@/lib/unsplash/getContent'
import PhotoGalleryItem from './PhotoGalleryItem.astro'
import { getLocaleFromUrl } from '@/utils/i18n/getLocaleFromUrl'
import { ACCOUNT_ID, UNSPLASH_BASE_URL } from '@/consts'

type Props = {
  photos: UnsplashPhotoData
}

const locale = getLocaleFromUrl(Astro.url)
const t = await getEntry('i18n', `${locale}/translation`)
const { photos } = Astro.props
const username = await getPhotographer()
---

<div class="photo-gallery-wrapper">
  <section class="photo-gallery">
    {
      photos &&
        photos.results.map((photo, i) => (
          <PhotoGalleryItem {photo} order={i + 1} />
        ))
    }
  </section>
  <aside>
    <p>
      {t.data.photo_gallery.credit_label}
      <cite>
        <a href={`${UNSPLASH_BASE_URL}/@${ACCOUNT_ID}`}>{username.name}</a>
      </cite>
      /
      <cite>
        <a href={UNSPLASH_BASE_URL}>Unsplash</a>
      </cite>
    </p>
  </aside>
</div>
<style>
  .photo-gallery-wrapper {
    display: grid;
    gap: 1.25rem;
    padding: 0 0.375rem 0.875rem 0.375rem;
    aside {
      p {
        font-size: 0.875rem;
        a {
          color: var(--accent);
          &:hover {
            color: var(--accent-dark);
          }
        }
      }
    }
    .photo-gallery {
      display: grid;
      align-items: flex-start;
      grid-template-columns: repeat(auto-fit, minmax(9.275rem, 1fr));
      grid-auto-flow: row dense;
      gap: 1.5rem;
    }
  }
  @media (min-width: 640px) {
    .photo-gallery-wrapper {
      .photo-gallery {
        grid-template-columns: repeat(auto-fit, minmax(9.675rem, 1fr));
      }
    }
  }
  @media (min-width: 768px) {
    .photo-gallery-wrapper {
      aside {
        p {
          font-size: 1.025rem;
        }
      }
      .photo-gallery {
        display: unset;
        columns: 3;
      }
    }
  }
  @media (min-width: 1024px) {
    .photo-gallery-wrapper {
      .photo-gallery {
        columns: 2;
      }
    }
  }
  @media (min-width: 1280px) {
    .photo-gallery-wrapper {
      .photo-gallery {
        columns: 3;
      }
    }
  }
</style>
